\documentclass{article}
\usepackage{amsmath,amssymb}
\usepackage{graphicx}
\usepackage{bm}
\usepackage[numbers]{natbib}
\usepackage{color}

\title{The binary liquid model for gravity-driven microchannel simulations}
\date{\today}
\newcommand{\Ca}{\mathrm{Ca}}
\newcommand{\todo}[1]{{\color{red}#1}}
\begin{document}

\maketitle

\begin{abstract}
The motion towards exploration of nano- and microscale phenomena brings new
challenges to simulation tools. The continuous physics approach is limited on
those scales, and methods such as Molecular Dynamics (MD) or the Lattice
Boltzmann Method (LBM) become more appropriate. This work aims to
reproduce the gravity driven microchannel flow of a free surface liquid with the
help of the free-energy binary liquid lattice Boltzmann method. In the low capillary number
$\Ca$ regime, the flow is thoroughly described by Bretherton \cite{bretherton},
where the deposition film thickness is proportional to $\Ca^{2/3}$. The binary
liquid model we use is a continuous-interface multiphase model, which presents
the question of how to properly resolve the interface to obtain proper correlations \todo{between what?}.
In this work we investigate how the binary liquid model parameters and the grid resolution
need to be adjusted to properly simulate microchannel flows.  The presented results
should be of interest for industrial applications and to researchers simulating
Bretherton phenomena.
\end{abstract}


\section{Introduction}
Taylor/Bretherton \cite{bretherton} flow describes flow of long bubbles in
microchannels. It was found that the front meniscus film width is proportional
to $Ca^{2/3}$ for Capillary numbers less than $0.003$. While there are number
of works which simulate the Bretherton problem with the boundary value method
\cite{ingham-plates,heil-bretherton}, the simulation of Bretherton problem is of
difficulty for diffusion interface methods, where the interface is spread over
the few grid nodes. In this case the question of proper film width resolution
arises. While the discontinuous interface models are good to simulate
non-complicated geometries phenomena, the continuous interface methods are more
flexible to resolve problem evolving coalescence or droplet breakup. This work
concentrates on the resolving parameters range of the binary liquid lattice
Boltzmann method to validate it across the Bretherton problem. 

Lattice Boltzmann method has emerged as successful method to simulate various
phenomena as hydrodynamics \cite{yu}, thermal-flows
\cite{karlin-minimalmodels}, micro-flows \cite{ansumali-small-knudsen},
ferrofluids \cite{kuzmin-aniso}, and multiphase flows
\cite{swift,Shan-chen:extended}. Based on kinetic nature and as a particle
method LBM tackles relatively easy complex geometries and the incorporation of
physics phenomena on the microscopic level, as multiphase models. Most
multiphase lattice Boltzmann models \cite{swift, Shan-chen:extended} resolve
the interface in the continuous way. Such representation as it was pointed out
brings issues with the film thickness resolution versus the interface
resolution. In other words, when it comes to the resolution of the film
thickness the diffusion interface should be resolved in such way as to have
negligible effect on physics in the film. 

This work examines the binary liquids free-energy LBM model \cite{swift}. The
model simulates binary liquids within the assumption of the uniform overall
density. Therefore, the question of how to simulate the Bretherton problem
where two phases are completely of different densities (liquid and gas) is of
interest. However, the motion of a liquid slug and a bubble in a capillary is
governed by the capillary number. Therefore, the viscosities ratio not the
densities ratio is the critical parameter. 

The goal of this paper is to give the answer as to how to choose related to the
binary liquid model parameters, viscosities ratio and grid
resolution to obtain the Bretherton/Taylor problem film thickness for the
diffusion interface model. The paper is organized as follows. We briefly
explain the binary liquid lattice Boltzmann model and summarize literature
review for the Bretherton problem. Then the parameters involved in the
simulation are examined and presented in the results section. The paper is
concluded with main findings.

\section{Bretherton bubble flow}
Bretherton in his significant work \cite{bretherton} studied a long bubble
moving in a tube filled with liquid. It was found that the deposition film is
proportional to $Ca^{2/3}$ in the range of small capillary numbers. Later on
it was figured \cite{wong-films,wong-pressure} that the film deposition
proportinal to $Ca^{2/3}$ only near the front meniscus and the film width is
variated through the bubble length for not infinite bubbles. Numerical
simulations \cite{giavedoni-numerical} and experimental studies
\cite{kreutzer-pressure-drop} show as well the deviation of rule $Ca^{2/3}$ for
capillary numbers more than $0.003$ and Reynolds number dependance. To be able
to predict consistently the flow pattern for capillaries in different range of
the parameters researchers validate their codes with the small capillary
numbers Bretherton problem.  

There are a number of the numerical methods which
were used for the Taylor/Bretherton flow
simulation. \citet{vanbaten-circular} studied the mass transfer and film
thickness for rising bubbles in a circular capillar.
\citet{kreutzer-pressure-drop} performed numerical simulation by the
finite volume method the circular capillary for the number of different
Reynolds and capillary numbers. \citeauthor{wong-films} in
\cite{wong-films,wong-pressure} studied three-dimensional bubbles in the
polygonal capillaries and showed the derivations of different shapes in the
slug crossections and menisci appearance.
\citet{heil-bretherton,ingham-plates} studied the air finger propagation to
the two-dimensional channel for the range of Reynolds numbers and capillary
numbers. \citet{giavedoni-numerical} performed crossvalidation of the
finite element solution developed by them with the already published results
across the different capillary numbers. The solution is available for circular
and planar cases. 

While the applicability of other methods are well established for the
simulation of the Bretherton/Taylor problem, the lattice Boltzmann
applicability and thorough parameters study to the best authors' knowledge is
not yet done. Especially that concerns the diffuse interface multiphase
models, where one needs to resolve the film accordingly. One should acknowledge
the works of
\citet{pagonabarraga-fingers} on meniscus in thin films for the fingering
phenomena. \citet{sehgal-microchannel} performed the lattice Boltzmann
simulations of two-dimensional channel flow for larger capillary numbers where
the authors found the discrepancies with the classical Bretherton theory having
limitations to the low capillary numbers regime \cite{giavedoni-numerical}.

While to resolve interface on a fine level for capillary numbers less than
$0.003$ is computationally extensive even for a two-dimensional case. For
instance for capillary number $0.01$ to properly resolve the interface one
needs around 22 GB memory requirement. Therefore, this work is based on the
comparison with the already established results which were in their case
validated over the Bretherton bubble flow. The work presents recipes for the
initialization and the optimal parameter range for the binary liquid LBM model,
which is described in the next section. 

\section{Lattice Botlzmann binary liquid model}
The lattice Boltzmann equation operates on the rectangular grid representing the
physical domain. It utilizes the
probability distribution functions containing the information about the
macroscopic variables, such as density,
momentum. LBE consists from two parts: local collision and propagation operated
from one node to another in the certain
direction specified by the velocity set.  The lattice Boltzmann implementation
in a standard view representing the
collision and propagation steps:
\begin{equation}
\label{standard:implementation}
\begin{aligned}
&f_i^{*}(\bm{x},t)=\omega f_i^{eq}(\bm{x},t)-(1-\omega) f_i(\bm{x},t) +
F_i,&&\text{ collision step}\\
&f_i(\bm{x}+\bm{c_i},t+1)=f_i^{*}(\bm{x},t),&&\text{ propagation step}, 
\end{aligned}
\end{equation}
where $F_i$ is the external force population. The binary liquid LBM model is
based on the free-energy functional \cite{swift,landau} and operates with two
sets of populations one to track pressure and velocities fields, another one is
for the phase field. The model to be utilized is two-dimensional nine-velocity
D2Q9 model.

In terms of D2Q9 the equilibrium populations are as \cite{pooley-contact}:
\begin{equation}
\begin{aligned}
&f_i^{eq}=w_i 
\biggl(3
p_0 - k \phi \Delta \phi
+\frac{u_{\alpha}c_{i\alpha}}{c_s^2}+\frac{Q_{i\alpha\beta}u_{\alpha } u_ {
\beta}}{2 c_s^4}\biggr), i=1\div8\\
&f_0^{eq}=\rho-\sum_{i\neq0}{f_i^{eq}}\\
&g_i^{eq}=w_i(\Gamma \mu + \frac{\phi c_{i\alpha} u_{i\alpha}}{c_s^2}+\phi^m
\frac{Q_{i\alpha\beta}u_{\alpha}u_{\beta}}{2 c_s^4}), i=1\div8 \\
&g_0^{eq}=\phi-\sum_{i\neq0}{g_i^{eq}}\quad,
\end{aligned}
\end{equation}
where $\Gamma$ is the mobility parameter; chemical potential
$\mu=-A\phi+A\phi^3-k\Delta\phi$; $k$ is related to the surface
tension; $A$ is the parameter of the free-energy model; bulk pressure
$p_0=c_s^2 \rho +A (-0.5 \phi^2+0.75 \phi^4)$. D2Q9 related parameters are
$w_i=\left\{\frac{4}{9},\frac{1}{9},\frac{1}{9},\frac{1}{9},\frac{1}{9},
\frac{1}{36},\frac{1}{36},\frac{1}{36},\frac{1}{36}\right\}$, and
$Q_{i\alpha\beta}=c_{i\alpha} c_{i\beta} - c_s^2 \delta_{\alpha\beta}$ with
the sound speed parameter $c_s^2=\dfrac{1}{3}$. Weights related to the
inclusion of the surface tension coefficient are as follows:
$w^{xx}_{1-2}=w^{yy}_{3-4}=1/3$, $w^{xx}_{3-4}=w^{yy}_{1-2}=-1/6$,
$w^{xx}_{5-8}=w^{yy}_{5-8}=-1/24$, $w^{xy}_{1-4}=0$, $w^{xy}_{5-6}=1/4$ and
$w^{xy}_{7-8}=-1/4$. Note that the system restores the macroscopic
equations as:
\begin{equation}
\begin{aligned}
&\partial_t \rho+ \partial_{\alpha} \rho u_{\alpha}=0\\
&\rho\left(\partial_t+u_{\beta}\partial_{\beta}\right) u_{\alpha}=
-\partial_{\alpha}P_{\alpha \beta} +
\nu\partial_{\beta}\left(\partial_{\alpha}u_{\beta}+\partial_{\beta} u_{\alpha}
+ \frac{1}{3}\partial_{\gamma} u_{\gamma} \delta_{\alpha\beta}\right)\\
&\partial_t \phi + \partial_{\alpha} \phi u_{\alpha}=M \Delta \mu,
\end{aligned}
\label{binary:fluid:system}
\end{equation}
where the viscosity $\nu=c_s^2 (\tau-1/2)$ and mobility parameter
$M=\Gamma(\tau_{\phi}-1/2)$. The system allows the separation of the liquid
phase with $\phi=1$ and so-called gas phase with $\phi=-1$. Note that the
spatial variation of the relaxation parameter depends on the relaxation
parameter of $\tau_{gas}$ and $\tau_{liq}$ linearly as
$\tau=\tau_{gas}+\frac{\phi+1}{2}\tau_{liq}$. Note that the surface tension in
the framework of binary liquid model as $\sqrt{8 k A}{9}$.

\section{Lattice Botlzmann benchmark}
To properly simulate and to compare simulations results with the already
performed simulations one needs to design a numerical benchmark by addressing
the following challenges for the lattice Boltzmann method:
\begin{itemize}
 \item The diffusive interface nature of the multiphase model should not
influence the film width results. This is obviously achieved only for certain
resolutions of the diffuse interface in comparison with the film width.
 \item The spurious currents arising from the surface tension discretization
can influence the mass transfer in the thin film therefore comprimising the
overall solution. Therefore the bubble should be long enough to decrease the
influence of the spurious currents.
 \item The wettability coefficient which is in principle can control the
dynamic angle and menisci appearance \cite{pagonabarraga-finger} should not
influence on the overall solution.
 \item The free-energy model examined in the work is one density/different
viscosities model. Classical Bretherton problem is the free-interface problem
where the film thickness is established by itself. The viscosities ratio should
be large as it is indicated in \cite{pagonabarraga-fingers}, however no studies
address this issue.
  \item The Bretherton problem addresses the bubbles flow driven by pressure
difference but not body force. However, it's relatively difficult to impose the
pressure difference in the framework of the binary liquid model because two
boundary conditions with the associated gradients and laplacians are required.
The pressure boundary conditions for the binary liquid model are currently
under development. Preliminary results show that the differences between
pressure difference flows and body force driven flows are small for the film
deposition thickness, the interest of this study. Thus, the work's focus is at
the body force driven flows because of the better simulation stability and
realization along with the periodic boundary conditions.
 \item Most simulations are done across the circular shape of channel,
which is quite difficult to address in terms of lattice Boltzmann free energy
framework where one needs to calculate the laplacians near the boundaries.
Although one can apply certain finite difference stencils
\cite{arnold-boundary,hunt-boundary} developed for the curved boundaries
however the analysis of error which can be addressed to the boundary conditions
treatment becomes an issue. Therefore the benchmark is for an axis-symmetric
case. 
\end{itemize}
Given all the concerns and challenges the suggested Lattice Boltzmann framework
is the two-dimensional flow driven by a body force. However, the analytical
solution to this problem, to the best authors' knowledge, is not yet known.
Though some authors \cite{sehgal-microchannel} use the gravity driven model to
validate the Bretherton film thickness, the latter should be used with caution
since the velocity of the bubble is different from the fluid velocity and a
bubble shape
is different in front and rear menisci. \citet{wong-films} indicated that the
film width for polygonal capillaries
changes from $Ca^{1/2}$ on distances $x\propto Ca^{-1}$ to $Ca^{2/3}$ for
distances $x \gg Ca^{-1}$. Therefore, for a bubble to have a formed shape in
the  front meniscus we picked up the bubble length as $5$ channel heights. The
channel length is taken to minimize the influence of one bubble on another,
because of the periodicity of boundary conditions. For the simulations the
channel length is taken as $3$ bubble lenghts giving all together $15$ channel
heights. Figure \ref{fig:benchmark:sketch} represents the benchmark sketch.
\begin{figure}
%\includegraphics[width=0.97\textwidth]{}
\caption{{\color{red} Ask Sasha to help here. The benchmark sketch.}
\label{fig:benchmark:sketch}}
\end{figure}


\section{Results}
\subsection{The nondimensionalization and initialization procedure}
This section is to introduce the procedure of nondimensionalization and
initialization techniques to be able to predict parameters necessary for
simulation. The capillary number governs the interface thickness and defined as:
\begin{equation}
Ca=\frac{U_{bubble} \mu_{liq}}{\gamma},
\end{equation}
where $\mu_{liq}$ is the liquid viscosity, $\gamma$ is the surface tension. The
bubble velocity $U_{bubble}$ is taken in the center of the bubble where the film
thickness is examined. 
While parameters as $\mu_{liq}$, $\gamma$ and capillary number $Ca$ are given
or defined through the model parameters, the velocity $U_{bubble}$ is not
defined. In the simulation we approximately match the velocity with the
Poiseuille profile center velocit, which is given by the equation:
\begin{equation}
\begin{aligned}
U_{bubble} \approx U_{liq}=\frac{H^2}{8
\mu_{liq}}\frac{\mathrm{d}P}{\mathrm{d}x}\\
U_{bubble}\approx
\frac{{N_y}^2}{\frac{8}{6}(\tau_{liq}-\frac{1}{2})}\frac{\mathrm{d}P}{\mathrm{d}
x } ,
\end{aligned}
\end{equation}
By taking the Poiseuille profile one can estimate the body force through the
capillary number and grid resolution:
\begin{equation}
\label{poiseuille:velocity:center}
\begin{aligned}
&\frac{\mathrm{d}P}{\mathrm{d}x}=\frac{8}{{N_y}^2}\gamma Ca.
\end{aligned}
\end{equation}
In reality we iterate the body force value
until the desired velocity and the capillary number as well are achieved. 

After one resolves necessary parameters to run a simulation, one needs to
initialize the macroscopic fields and populations.
The velocity is initialized with $0$ everywhere. Populations are initialized
with the equilbrium values for the binary liquid model including all the phase
gradients and laplacians. The liquid phase is initialized with $1$ and the
gas phase is initialized with $-1$. Though the initialization film thickness
is not involved in the final result for the front meniscus, Fig.
\ref{fig:different:initialization:widths}, we keep the initialized film
thickness as close as possible to the already obtained numerical film
thicknesses \cite{giavedoni-numerical}. Otherwise, the simulation time for the
bubble to obtain a steady-state form increases.
\begin{figure}
\includegraphics*[bb=-20 360 620 430,width=0.97\textwidth]
{Figures/Init/initbegin12.eps}
\includegraphics*[bb=-20 360 620 430,
width=0.97\textwidth]{Figures/Init/initbegin16.eps}
\includegraphics*[bb=-20 360 620 430,
width=0.97\textwidth]{Figures/Init/initbegin20.eps}
\includegraphics*[bb=-20 360 620
430,width=0.97\textwidth]{Figures/Init/initfinish12.eps}\\
\includegraphics*[bb=-20 360 620
430,width=0.97\textwidth]{Figures/Init/initfinish16.eps}\\
\includegraphics*[bb=-20 360 620
430,width=0.97\textwidth]{Figures/Init/initfinish20.eps}\\
\caption{The phase plots for different bubble widths as
$H_{eff}-12$,$H_{eff}-16$ and
$H_{eff}-20$. The grid for the simulation is $102\mathrm{x}1501$. The phase
profiles were obtained after $200000$ time steps. One can see that even the
system is initialized with different bubble volumes the system comes to the
shape, where the film thickness is conserved. For the given parameters the
interface thickness is $0.0615$, $0.0611$, $0.0605$.
\label{fig:different:initialization:widths}}
\end{figure}

Here two different examples are presented that can quantitatively show the
initialization procedure for quite different capillary numbers. In these
examples we use $k=0.04$ and $A=0.04$ as optimal binary liquid model parameters.
That explicitly implies the surface tension to be $\sqrt{\frac{8 k
A}{9}}=0.0377$ and the characteristic length of the interface
$5\sqrt{\frac{k}{A}}=5$ lattice boltzmann units. For the sake of simplicity and
stability the relaxations parameter for liquid and gas phases are taken as
$\tau_{liq}=2.5$ and $\tau_{gas}=0.7$. That gives the gas-liquid viscosity ratio
as $10$.  
\begin{description}
 \item[I \bm{$Ca=0.005$}]
  The film width for such small Capillary numbers \cite{bretherton} is
given by equation:
  \begin{equation}
  \frac{h_{\infty}}{H}=1.3375 Ca^{2/3}=0.03899,
  \end{equation}
  where we assume that $2 H$ or $Ny$ in lattice units is the channel width.
Therefore one needs to resolve the interface which is around $2$ percent of
  whole channel width with for instance $8$ lattice units, where $5$ lattice
units occupies the interface width for given. Note that the interface occupies
$62.5$ percent of the interface.  Therefore the channel
  width is $400$ lattice units. We take the bubble length as $5$ channel widths
  and the distance between bubble is as $2$ bubble lengths. It gives the
grid size as $400\mathrm{x}6000$. In terms of computer memory
requirement the calculations with the double precision accuracy demand:
\begin{equation}
\begin{aligned}
&2\text{ set of populations }\mathrm{x}\,\, 8\,\, \text{bytes per population
}\mathrm{x}\,\, 9 \text{ number of
populations}\\
&\mathrm{x}\,400\,\mathrm{x}\,6000\approx 345 \mathrm{MB}. 
\end{aligned}
\end{equation}
Even with this naive assumption for the $50$ percent resolution of the film
widht in comparison with the interface width, one can get the memory
requirement as $345 MB$. 

After resolving the interface one can  calculate the
  velocity from the capillary number as:
  \begin{equation}
  U_{bubble}=0.005 \frac{\gamma}{\mu_{slug}}=0.005
\frac{0.0377}{0.66666}=2.82\,10^{-4},
  \end{equation}
  where $\mu_{slug}=1/3 (2.5-0.5)=0.6666$.
  This velocity implies the following pressure gradient calculated from the
  Poisuielle flow solution:
  \begin{equation}
  \begin{aligned}
  &U_{bubble}=\frac{H^2}{8\mu} \frac{\mathrm{d}P}{\mathrm{d}x}=\frac{Ny^2}{8/3
  (\tau_{liq}-1/2)}\frac{\mathrm{d}P}{\mathrm{d}x}\\
  &\frac{\mathrm{d}P}{\mathrm{d}x}=\frac{8}{Ny^2}\gamma Ca
  \end{aligned}
  \end{equation}
  Therefore the pressure gradient established is the following:
  \begin{equation}
  \begin{aligned}
  \frac{\mathrm{d}P}{\mathrm{d}x}=9.42\, 10^{-9}.
  \end{aligned}
  \end{equation}
  Note that in the case of large grids  height resolution is directly
involved in	
the physical time step as:
\begin{equation}
\Delta t =\frac{U_{LBM}}{U_{phys}} \Delta x ,
\end{equation}
where for example the real velocities in the physical world can reach
approximately $1$ m/s and physical channel height upto $1$ mm. In this case one
can easily approximate the physical time step:
\begin{equation}
\Delta t = 7.05 \, 10^{-10} \,\mathrm{s}
\end{equation}
which is a small time step. The typical simulation needs approximately
$100000-300000$ time steps to come to the steady state solution giving the
physical time simulation around $10^{-5}--10^{-4}\,\mathrm{s}$, which is
probably not enough to find desired correlations.

 \item[II $\bm{Ca=0.05}$] 
   The parameters in the previous subsection imply very long
simulations. Bretherton delivered his solution for the range of Capillary number
less than
  $0.005$. However, a lot of simulations devoted to the Bretherton/Taylor
flow
  simulated and extended it in the range of Capillary numbers greater than
$0.005$
  and for different Reynolds numbers. One can refer to figures
  \ref{fig:giavedoni:planar} and \ref{fig:heil:planar} taken from citations
  \cite{giavedoni-numerical,heil-bretherton} which crossvalidated their
  simulations with Bretherton and each other. Even though LBM can simulate the
flows with small capillary numbers, i.e. less than $0.005$, but waiting time
for the simulation to be accomplished is relatively long. Therefore, we focus
our work on the simulations of \citet{giavedoni-numerical} which crossvalidated
results not only for small capillary numbers but for large capillary numbers as
well. As far as the work intention is
  to show proper physics behavior the moderate parameters are
taken which
  can be easily and fast validated on a computer. 
  One can see from the Fig. \ref{fig:heil:planar} that the width for the
  Capillary number equal to $0.05$ ranges from $0.12$ to $0.15$ while Reynolds
  number ranges from $0$ to $300$. This capillary number has moderate film
widths
  to be resolved with certain accuracy. 

  The film width for such small Capillary numbers is taken from
  \ref{fig:heil:planar} for Reynolds number $40$ equals to $0.12$. We want to
  resolve $6\%$ of whole channel width with $12$ lattice units, where $5$
lattice units are related to the interface resolution.  Therefore the channel
  width is $200$ lattice units. We take the bubble length as $5$ channel widths
  and the distance between slugs we take as $2$ bubble lengths. That gives
the grid size as $200\mathrm{x}3000$. The velocity can be
calculated from the Capillary number as:
  \begin{equation}
  U_{bubble}=0.05 \frac{\gamma}{\mu_{liq}}=0.05 \frac{0.037712}{0.6666}=2.82\,
  10^{-3}.
  \end{equation}
  The velocity implies the following pressure gradient calculated from the
  Poisuielle flow solution:
  \begin{equation}
  \begin{aligned}
  &\frac{\mathrm{d}P}{\mathrm{d}x}=\frac{8}{Ny^2}\gamma Ca=3.77\,10^{-7}.
  \end{aligned}
  \end{equation}
  The initialization approach is to take values from the already performed
numerical simulation and to calculate the grid numbers from them matching the
body force gradient through the solution of Poiseuille flow.   

\end{description}
\begin{figure}
\includegraphics[width=0.97\textwidth]{Figures/giavedoni_planar.eps}
\caption{\citet{giavedoni-numerical} gathered results across the
literature for different Capillary numbers \label{fig:giavedoni:planar}}
\includegraphics[width=0.97\textwidth]{Figures/heil-planar.eps}
\caption{\citet{heil-bretherton} performed simulations for different ranges of
Capillary numbers and Reynolds numbers. \label{fig:heil:planar}}
\end{figure}
Note that we base the initialization techniques through correlations for the
capillary number and the body force. However, in the binary liquid framework
those correlations give only the approximation. First of all the body force
which is based on the Poiesuille velocity profile for the liquid phase is the
biggest assumption. In reality the less viscous bubble will have a slippage
factor and its velocity is larger than the surrounding liquid velocity. By
plugging in the obtained velocity back to the capillary number equation the
larger capillary number can be obtained. While we present the initialization
tips, in reality one needs to take the bubble velocity from the simulations and
recalculate all the necessary characteristics or in other words adjust the
forcing to obtain the desired velocity/capillary number. 

\subsection{Grid refinement}
To properly estimate the interface resolution one needs to perform the
convergence study dependance on the grid resolution. All parameters are fixed,
including a bubble velocity, the capillary number and change the grid
resolution. Our goal is to know exactly the ratio of the interface width to the
film thickness where results are not dependant on the grid resolution. 

The example what we want to simulate is the capillary number
$0.05$. As it was pointed out the film thickness in that case is $6$ percent.
Note that in the case of half-way bounce-back walls which are used in the
simulations one needs to calculate the film thickness as: 
\begin{equation}
\delta=(\phi_0-0.5)/(N_y-2),
\end{equation}
where $\phi_0$ is the grid coordinate where phase field equals to $0$, $N_y-2$
is related to the effective channel height. Note that it's a big
simplification to impose the boundary in the middle beetween the bounce-back
node and the fluid node which give rise to the viscosity dependent location of
the wall \cite{ginzburg-multireflection}. In the case of $\delta=0.06$ the
initial grid number
is $N_y=102$, which gives the horizontal grid number as $N_x-1=15(N_y-2)=1500$.
The bubble is initialized as a rectangular box with coordinates
$y=7\dots N_y-8$, $x=\frac{N_x}{3}\dots \frac{2 N_x}{3}$ and phase
$\phi_{bubble}=-1$. All other nodes are initialized with the phase field
$\phi=1$. The force gradient can be estimated through the Poiseuille
profile formula, Eq.\ref{poiseuille:velocity:center}, and it equals
$1.508\,10^{-6}$.

After choosing the reference parameters, the grid refinement needs to keep the
same the same macroscopic parameters as capillary number and viscosities ratio.
Therefore the simulations were performed with grid
numbers $N_y=102,127,152,177,202,227$, corresponding to the
effective channels widths as $H_{eff}=100,125,150,175,200,225$,
$N_x=1501,1876,2251,2626,3001,3376=15
H_{eff}+1$. It is easy to check
that keeping all liquid viscosities the same yields the following quantity to
be a
constant while doing the grid refinement
$H_{eff}^2\frac{\mathrm{d}P}{\mathrm{d}x}=(N_y-2)^2\frac{\mathrm{d}P}{\mathrm{d}
x } = Const$. We performed a number of simulations for the prescribed grids.
The unified scaled profiles are shown in Fig. \ref{fig:grid:profiles}. One can
see the visual results convergence for $H_{eff}\geq 175$. The calculated widths
are $0.0606$,$0.0618$,$0.0617$,$0.0629$,$0.0624$,$0.0624$. We accept the
convergent results for grids larger than $H_{eff}=175$. However, one can see
that imposing proper initialization technique, large enough time and the wall
wettability reveal results which are different only in 3rd digit even for
underresolved film widths. To calculate how good the interface thickness is
resolved the interface thickness to the film width thickness is calculated.The
interface itself occupies approximately $5 \xi$, where
$\xi=\sqrt{k/A}=1$. Let us calculate the interface width ratio to the film
thickness as
$5\xi/H_{film}$ is as follows $0.824$, $0.646$,  $0.539$, $0.453$,
$0.400$, $0.355$. Therefore, one needs to
resolve the interface as $40-50$ percent of the
expected film width for simulations to be converged. We further examine the
velocities in the center of the bubble to calculate the Capillary number. The
calculated numbers are $0.0041$, $0.0041$,$0.0040$,$0.0040$,$0.0041$,$0.0039$.
This corresponds to the average capillary number as $0.07$, which is slightly
larger than the expected capillary number. The corresponding error can be
attributed to the density and viscosity ratio which is much larger in the
Bretherton problem.
\begin{figure}
\includegraphics[width=0.97\textwidth]{Figures/Grid/norm_grid_profs.eps}
\caption{Grid refined profiles for the effictive
channel widths
$H_{eff}=100,125,150,175,200,225$.One can see
convergent results even for the underresolved film
thickness.\label{fig:grid:profiles}}
\end{figure}

\subsection{The influence of the wall gradient}
The results should not depend on the wall wettability. Wettability is defined
through the phase gradient \cite{pooley-contact}, $\partial_n \phi$. This
section is to examine the wall gradient influence on simulations. We take large
enough resolution for simulations to be consistent. Simulation domain was
chosen as $177\mathrm{x}2626$ and the initial film width as
$12$ lattice boltzmann units, which correspond to the predicted film thickness.
We examined $11$ different values for the wall
gradient ranging from $-1$ to $1$. The results are consistent among all the
wall gradients given that the interface is resolved in the right way. For the
given wall gradients the values of interface thicknesses are
$0.0633$,$0.0634$,$0.0634$,$0.0634$,$0.0634$,$0.0634$,$0.0633$,$0.0632$,
$0.0631$. The results are different in 4th digit. For the wall gradients $0.8$
and $1.0$ the
simulations are unstable. One can see the simulated profiles in Fig.
\ref{fig:gradients:profiles} The negative values of the phase gradient are
preferable, as
far as the phase of the liquid adjacent to the wall has the value of $1$. That
means that the phase values near the wall are above $1$ and do not interact
with the bubble which has phase value $-1$.  In case of positive
gradients the values near the wall are below $1$ and the gradient profile can
fuse with the values of the gas phase as $-1$, creating the wall stickyness,
unphysical one.
\begin{figure}
\includegraphics[width=0.97\textwidth]{Figures/Wall/phase_grad_profiles.eps}
\caption{Phase profiles for different wall gradients. One can see if the width
is properly resolved then the wettability of the wall doesn't play any role
affecting the film thickness.
\label{fig:gradients:profiles}
}
\end{figure}
Another question which arises is the influence of the wall gradient on the bubble velocity and the
capillary number accordingly. The shear stress controlled by the wall phase gradient changes the
effective velocity near the wall, thus changing the bubble velocity as well.
One can see that if the film thickness is resolved properly the influence of the wall gradient can
be neglected. Fig. \ref{fig:velocities:wall:gradient} shows the center bubble velocity for different
gradients. The average relative error around the mean velocity is $0.1\%$. 
\begin{figure}
\includegraphics[width=0.97\textwidth]{Figures/Wall/velocities_grad_profiles.eps}
\caption{The center bubble velocity versus the phase gradient. One can neglect the influence of
the wall once the film is properly resolved.
\label{fig:velocities:wall:gradient}
}
\end{figure}

\subsection{Capillary number region}
The purpose of this section is to validate the correlations of
\citet{giavedoni-numerical}, Fig. \ref{fig:giavedoni:planar}, and
\citet{heil-bretherton}, Fig. \ref{fig:heil:planar}, for the range of capillary
numbers. Because of limiting computational factors as memory and the
performance we cannot go to the range of small
capillary numbers. However, all the other methods were validated across the
small capilary numbers and extended for the range of capillary numbers from
$0.005$ to $10.0$. Our goal is to compare the film thickness over the capillary
range from $0.03$ to $0.8$, which is a computationally reasonable task.  For the
benchmark
results we
suggest the following Capillary numbers as:
\begin{equation}
0.03,0.05,0.08,0.1,0.2,0.4,0.6,0.8\, .
\end{equation}
The corresponding approximate film widths from \cite{giavedoni-numerical} are as
follows:
\begin{equation}
0.04,0.06,0.08,0.1,0.12,0.13,0.15\,.
\end{equation}
To perform numerical simulations we refer
to
grid refinement section where we obtained that the interface width should be
at most $50$ percent of the interface width. Therefore the grid was chosen as
$202 \mathrm{x} 3001$. $5$ lattice boltzmann units do not occupy more than $60$
percent of the effective width. Because the simulation get unstable with
smaller grids and larger gradients, all the capillary number simulations were
performed on the grid chosen. To properly initialize the force gradient the
proportionality law was utilized. For instance, with the forcing
$6\,10^{-6}/16$ was chosen for the grid to obtain predicted capillary number as
$0.005$. Therefore, one can obtain the initial forcing for other grids using
simple correlations: 
\begin{equation}
\begin{aligned}
&Ca_{lit} \propto U_{bubble}\\
&U_{bubble} \propto \frac{\mathrm{d}P}{\mathrm{d}x} N_y^2\\ 
&Ca_{lit} \propto \frac{\mathrm{d}P}{\mathrm{d} x} N_y^2 \text{ or }\\
&\frac{\mathrm{d}P}{\mathrm{d} x} \propto \frac{Ca_{lit}}{N_y^2},
\end{aligned}
\end{equation}
where the index $lit$ stands for the predicted capillary number
\cite{giavedoni-numerical,heil-bretherton}. The grid number $N_y$ is not
involved as because the simulations are conducted on the same grid.
Therefore,the pressure gradient can be obtained through the capillary numbers
ratio:
\begin{equation}
\frac{\mathrm{d}P}{\mathrm{d} x}=6\,10^{-6}/16 \frac{Ca_{lit}}{0.05}
\end{equation}
The film width is initialized through the capillary numbers ratio as well:
\begin{equation*}
w=12 \frac{Ca_{lit}}{0.05}
\end{equation*}
The results were obtained after $200,000$ steps. Film thicknesses were obtained as $0.042$,$0.066$, $0.085$, $0.077$, $0.123$, $0.153$, $0.164$, $0.173$ with the bubble center velocities as $0.0022$, $0.0041$, $0.0068$, $0.0055$, $0.0185$, $0.0388$, $0.0592$, $0.0782$. Based on the obtained center velocities the capillary numbers 
are formed as $0.039$,$0.072$,$0.120$,$0.098$,$0.328$,$0.686$,$1.046$,$1.383$. Those capillary numbers are overpredicted but the obtained lengths are overpredicted as well due to the improper body force imposement. 
We extracted data from \cite{giavedoni-numerical,heil-bretherton} and compared it with the simulation. The results are shown in Fig. \ref{fig:capillary:comparison}.
\begin{figure}
\includegraphics[width=0.97\textwidth]{Figures/Capillary/capillaries_comparison.eps}
\caption{The comparison between simulation results and results from \cite{giavedoni-numerical} and \cite{heil-bretherton}. One can see the reasonable agreement. The film thickness against the capillary number range is presented.\label{fig:capillary:comparison}}
\end{figure}


\subsection{The film variation over the bubble}
This section is intended to show the qualitative variation of the film thickness over the bubble.
Though there are simulations for the bubble length simulations for the two-dimensional case, due to
the presentation of data it is hard to extract numerical data. One can see bubble lengths
variations for the two-dimensional simulations for the range of capillary numbers in Fig.
\ref{fig:sehgal:bubble:length}.
\begin{figure}
\includegraphics[width=0.47\textwidth]{Figures/Bubble/bubble_length.eps}\hfill
\includegraphics[width=0.47\textwidth]{Figures/Bubble/bubble_sehgal.eps}\\
\caption{The qualitative comparison for the film thickness across
the bubble length. Right (courtesy of \citet{sehgal-microchannel}),
left (present simulations).\label{fig:sehgal:bubble:length}}
\end{figure}
One can see the qualitative agreement, i.e. the thickness increases towards the front meniscus and
rapidly decreases towards the rear meniscus. This shape sometimes is called as a "bullet" shape.


\subsection{The influence of different viscosities}
The results obtained earlier are taken for the liquiqs viscosity ratio $10$.
We performed the same simulations for the liquids viscosity ratio as $20$.
Parameters were taken as $\tau_{liquid}=4.5$ and $\tau_{bubble}=0.7$. We
haven't found significant differences with the results obtained earlier. The
comparison for the liquid thicknesses is presented on Fig.
\ref{fig:capillary:viscous}. Therefore one can validate the assumption that in
the low capillary flow regime the density ratio is not involved. As well the
gas-liquid viscosity ratio of the order $10$ is enough to obtain results
consistent with the Bretherton/Taylor problem. 
\begin{figure}
\includegraphics[width=0.97\textwidth]{Figures/Capillary_Viscous/capillaries_viscous.eps}
\caption{The widths versus capillary number comparison for
$\frac{\mu_{liq}}{\mu_{gas}}=10$ and $\frac{\mu_{liq}}{\mu_{gas}}=20$. The
results show good consistency and agreement.\label{fig:capillary:viscous}}
\end{figure}

\section{Conclusion}
The work presents the numerical tips and the benchmark for the
Bretherton/Taylor problem using the binary liquid lattice Botlzmann method. The
results show consistency with the already obtained numerical correlations using
other methods. Though results are specific for the binary liquid lattice
Botlzmann method but numerical tips and correlations can be used for any
continuous interface methods. The work is valuable for people simulating
microchannel flows.

\bibliographystyle{plainnat}
\bibliography{paper}

\end{document}
