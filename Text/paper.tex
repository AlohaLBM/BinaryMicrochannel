%% This is file `elsarticle-template-1-num.tex',
%%
%% Copyright 2009 Elsevier Ltd
%%
%% This file is part of the 'Elsarticle Bundle'.
%% ---------------------------------------------
%%
%% It may be distributed under the conditions of the LaTeX Project Public
%% License, either version 1.2 of this license or (at your option) any
%% later version.  The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.2 or later is part of all distributions of LaTeX
%% version 1999/12/01 or later.
%%
%% The list of all files belonging to the 'Elsarticle Bundle' is
%% given in the file `manifest.txt'.
%%
%% Template article for Elsevier's document class `elsarticle'
%% with numbered style bibliographic references
%%
%% $Id: elsarticle-template-1-num.tex 149 2009-10-08 05:01:15Z rishi $
%% $URL: http://lenova.river-valley.com/svn/elsbst/trunk/elsarticle-template-1-num.tex $
%%
\documentclass[preprint,12pt]{elsarticle}

%% Use the option review to obtain double line spacing
%% \documentclass[preprint,review,12pt]{elsarticle}

%% Use the options 1p,twocolumn; 3p; 3p,twocolumn; 5p; or 5p,twocolumn
%% for a journal layout:
%% \documentclass[final,1p,times]{elsarticle}
%% \documentclass[final,1p,times,twocolumn]{elsarticle}
%% \documentclass[final,3p,times]{elsarticle}
%% \documentclass[final,3p,times,twocolumn]{elsarticle}
%% \documentclass[final,5p,times]{elsarticle}
%% \documentclass[final,5p,times,twocolumn]{elsarticle}

%% if you use PostScript figures in your article
%% use the graphics package for simple commands
%% \usepackage{graphics}
%% or use the graphicx package for more complicated commands
\usepackage{graphicx}
%% or use the epsfig package if you prefer to use the old commands
%% \usepackage{epsfig}

%% The amssymb package provides various useful mathematical symbols
\usepackage{amsmath,amssymb}
\usepackage{bm}
%\usepackage[numbers,sort&compress]{natbib}
\usepackage{color}
\usepackage{tabularx}

%% The amsthm package provides extended theorem environments
%% \usepackage{amsthm}

%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers after \end{frontmatter}.
\usepackage{lineno}

%% natbib.sty is loaded by default. However, natbib options can be
%% provided with \biboptions{...} command. Following options are
%% valid:

%%   round  -  round parentheses are used (default)
%%   square -  square brackets are used   [option]
%%   curly  -  curly braces are used      {option}
%%   angle  -  angle brackets are used    <option>
%%   semicolon  -  multiple citations separated by semi-colon
%%   colon  - same as semicolon, an earlier confusion
%%   comma  -  separated by comma
%%   numbers-  selects numerical citations
%%   super  -  numerical citations as superscripts
%%   sort   -  sorts multiple citations according to order in ref. list
%%   sort&compress   -  like sort, but also compresses numerical citations
%%   compress - compresses without sorting
%%
%% \biboptions{comma,round}

% \biboptions{}

\journal{Chemical Engineering Journal}

\newcommand{\Ca}{\mathrm{Ca}}
\newcommand{\todo}[1]{{\color{red}#1}}

\begin{document}

\begin{frontmatter}
%% Title, authors and addresses

%% use the tnoteref command within \title for footnotes;
%% use the tnotetext command for the associated footnote;
%% use the fnref command within \author or \address for footnotes;
%% use the fntext command for the associated footnote;
%% use the corref command within \author for corresponding author footnotes;
%% use the cortext command for the associated footnote;
%% use the ead command for the email address,
%% and the form \ead[url] for the home page:
%%
%% \title{Title\tnoteref{label1}}
%% \tnotetext[label1]{}
%% \author{Name\corref{cor1}\fnref{label2}}
%% \ead{email address}
%% \ead[url]{home page}
%% \fntext[label2]{}
%% \cortext[cor1]{}
%% \address{Address\fnref{label3}}
%% \fntext[label3]{}

\title{Simulations of gravity-driven flow of binary liquids in microchannels}

%% use optional labels to link authors explicitly to addresses:
%% \author[label1,label2]{<author name>}
%% \address[label1]{<address>}
%% \address[label2]{<address>}

\author[uofa]{A.~Kuzmin\corref{cor1}}
\cortext[cor1]{Corresponding author}
\ead{shurik.kuzmin@gmail.com}
\author[us]{M.~Januszewski}
\ead{michalj@gmail.com}
\author[schlum]{D.~Eskin}
\ead{deskin@slb.com}
\author[schlum]{F.~Mostowfi}
\ead{fmostowfi@slb.com}
\author[uofa]{J.J.~Derksen}
\ead{jos@ualberta.ca}
\address[uofa]{Chemical and Materials Engineering, University of Alberta\\ 7th Floor, ECERF, 9107
116 St, Edmonton, Alberta, T6G
2V4 Canada}
\address[us]{Insitute of Physics, University of Silesia, 40-007 Katowice, Poland}
\address[schlum]{DBR Schlumberger Technology Center\\ 9450 17 Ave NW, Edmonton, Alberta, T6N 1M9
Canada}

\begin{abstract}
%This work shows that the free-energy binary liquid lattice Boltzmann method is able to
%reproduce the gravity driven microchannel flow of a gas bubble through liquid. In the regime of low
%capillary
%numbers
%$\Ca$ (defined in Eq.~\ref{capillary:number:definition}), the flow is thoroughly described by
%Bretherton \cite{bretherton},
%with the deposition film thickness proportional to $\Ca^{2/3}$. However, there are deviations
%from the Bretherton correlation for $\Ca\geq 0.005$, studied experimentally and numerically. This
%work aims to examine the applicability of the lattice Boltzmann binary liquid model to simulations
%of bubble flow in liquids for a range of $\Ca$ numbers. The binary
%liquid model is a continuous-interface multiphase model allowing to properly resolve the interface.
%It was found that the interface thickness needs to be $50$
%percent of the film thickness for the simulation to give convergent results. When
%the convergence criterion is fulfilled, the results are in a good agreement with the
%numerical simulations of \citet{giavedoni-numerical} in the range of $\Ca$ from $0.01$ to $1$. 
In this work a free-energy binary liquid lattice-Boltzmann scheme is used to simulate
Taylor/Bretherton flow in a micro-channel where elongated gas bubbles move through a liquid with
thin liquid films between the bubbles and the channel walls. The numerical scheme has a diffuse
interface, and a main focus of our work is to assess resolution requirements for correctly resolving
the liquid film and bubble motion. The simulations are two-dimensional and span a capillary number
range of $0.05$ to $1.0$ where the capillary number is based on the liquidâ€™s dynamic viscosity, the
velocity of the bubble, and the interfacial tension. The flow is driven by a body force, and
periodic boundary conditions apply in the streamwise direction. We obtain grid independent results
as long as the liquid film thickness is at least two times the width of the diffuse interface, with
film thicknesses in accordance to literature results. We also show that the results in terms of film
thicknesses are largely insensitive to the liquid-gas viscosity ratio and wettability parameters. 
\end{abstract}

\begin{keyword}
Bretherton problem \sep Microchannel simulation \sep Multiphase flow \sep Lattice Boltzmann method
\sep Binary liquid model \sep Flow between plates \sep Gravity driven
%% keywords here, in the form: keyword \sep keyword

%% MSC codes here, in the form: \MSC code \sep code
%% or \MSC[2008] code \sep code (2000 is the default)
\end{keyword}

\end{frontmatter}

%%
%% Start line numbering here if you want
%%
\linenumbers

%% main text

%% The Appendices part is started with the command \appendix;
%% appendix sections are then done as normal sections
%% \appendix

%% \section{}
%% \label{}

%% References
%%
%% Following citation commands can be used in the body text:
%% Usage of \cite is as follows:
%%   \cite{key}          ==>>  [#]
%%   \cite[chap. 2]{key} ==>>  [#, chap. 2]
%%   \citet{key}         ==>>  Author [#]

\section{Introduction}
The Taylor/Bretherton \cite{bretherton} flow deals with long gas bubbles moving through liquid in
narrow channels. It was found that the front meniscus film thickness is proportional
to $\Ca^{2/3}$ for capillary numbers smaller than $0.003$, where the capillary number is defined as:
\begin{equation}
\label{capillary:number:definition}
\Ca=\frac{\mu_\mathrm{liq} U_\mathrm{bubble}}{\gamma},
\end{equation}
where $\mu_{liq}$ is the liquid viscosity, $U_{bubble}$ is the bubble velocity, and
$\gamma$ is the interfacial tension between gas and liquid.

While there are many works which simulate the Bretherton problem by the boundary value approach
\cite{ingham-plates,heil-bretherton}, those methods are of limited applicability for problems
involving complex geometries, free interface motion, or for problems involving coalescence and/or
droplet breakup. The continuous interface models are more flexible for those kind of simulations.
However, if the interface is smeared out over several grid nodes, the question of
proper film resolution in comparison with the interface resolution arises.  This work is focused on
exploring the parameter range of the binary liquid lattice
Boltzmann method for correctly resolving the flow in a range of capillary numbers.

The lattice Boltzmann method has emerged as a successful method to simulate
a wide variety of phenomena including hydrodynamics \cite{yu}, thermal flows
\cite{karlin-minimalmodels}, microflows \cite{ansumali-small-knudsen},
ferrofluids \cite{kuzmin-aniso}, and multiphase flows
\cite{swift,Shan-chen:extended}. Thanks to its kinetic nature, LBM as a particle
method easily tackles complex geometries and allows incorporation of
physical phenomena on the microscopic level, as in the case of multiphase models. Most
multiphase lattice Boltzmann models \cite{swift, Shan-chen:extended} resolve
the interface using continuous interface methods where the interface spans over several grid nodes.
Such a representation
brings issues of the film thickness resolution versus interface
resolution -- the diffuse interface should be dealt with in such a way as to have a
negligible effect on the physics of the film.

The binary liquid free-energy LB model due to \citet{swift} we used
simulates two liquids with the assumption of uniform overall
density. While the classical Bretherton problem is stated for gas and liquid, which are of
significantly
different densities and viscosities, it was indicated \cite{bretherton} that inertia effects were
neglected. Moreover, the results of \citet{giavedoni-numerical} and \citet{heil-bretherton} show
{\color{red} insignificant} Reynolds number effects on the film thickness for a relatively wide
range of Reynolds
numbers. 
{\color{red} For example, \citet{giavedoni-numerical} suggested that the Reynolds number effects
are negligible for $\Ca\leq0.05$ and have moderate changes for $\Ca>0.05$ in the range of Reynolds
number from $0$ to $70$. Later on, citet{heil-bretherton} extended results upto Reynolds number
$300$. The indicate that while the influence of the established film thickness is insignificant
($7$ percent from the film thickness measured at $Re=0$). However, the Reynolds number influence
significantly the pressure distrubution and the flow field near the front bubble tip. In the present
simulations the largest Reynolds number we achieve is less than $20$ and it allows to neglect the
inertia effects.} 
Therefore, the major governing factor for microchannel flows is not the density ratio, but the
viscosity ratio. Moreover, the results based on the uniform density, as in the case of the LBM
binary liquid model, are in good agreement with other simulations
\cite{giavedoni-numerical,heil-bretherton} in which inertia effects were taken into account.

The goal of this paper is to understand how to choose the
binary liquid model parameters, the viscosity ratio and the grid
resolution to obtain correct flow physics with an emphasis on film thicknesses.

The paper is organized as follows.  First, we review the literature
for the Bretherton problem and briefly
explain the binary liquid lattice Boltzmann model. Then, the parameters involved in the
simulation are examined and presented in the results section. The paper is
concluded with a summary of the main findings.

\section{Bretherton bubble flow}
Bretherton \cite{bretherton} studied a long bubble
moving in a tube filled with liquid. It was found that the deposition film thickness
is proportional to $\Ca^{2/3}$ in the range of small capillary numbers. Later,
it was realized \cite{wong-films,wong-pressure} that the film thickness
is proportional to $\Ca^{2/3}$ only in the certain region behind the front meniscus and
that the film thickness
varies over the bubble length for bubbles of finite length. Numerical
simulations \cite{giavedoni-numerical} and experimental studies
\cite{kreutzer-pressure-drop} showed a deviation from the $\Ca^{2/3}$ rule for capillary numbers
larger than $0.003$.
To consistently  predict a flow pattern for capillaries in
different ranges of parameters, simulations have been conducted and have been typically validated with the
small capillary numbers Bretherton problem.

There are a number of numerical methods which
were used for the simulation of the Taylor/Bretherton flow.
\citet{vanbaten-circular} studied the mass transfer and film
thickness for rising bubbles in a circular capillary using the finite volume method.
\citet{kreutzer-pressure-drop} also used the finite volume method to perform
simulations of a circular capillary for a number of different
Reynolds and capillary numbers. \citeauthor{wong-films} \cite{wong-films,wong-pressure} studied
three-dimensional bubbles in
polygonal capillaries and calculated bubble shapes in the
slug cross sections and menisci appearance.
\citet{heil-bretherton} and \citet{ingham-plates} studied gas finger propagation in
a two-dimensional channel for a range of Reynolds and capillary
numbers using the finite element method. \citet{giavedoni-numerical} performed cross validation of the
finite element solution with previously published results.
The solutions were obtained for circular and planar cases.

While the applicability of other methods has been demonstrated for the
simulation of the Bretherton/Taylor problem, this is not the case for
the lattice Boltzmann method. A thorough parametric study for this approach
has not been done to the best of the authors' knowledge.

One should acknowledge the works of \citet{pagonabarraga-fingers} on menisci
in thin films for fingering phenomena. \citet{sehgal-microchannel} performed lattice Boltzmann
simulations of two-dimensional channel flows for a relatively large capillary numbers, and
found discrepancies with the classical Bretherton theory, which
is limited to the low capillary number regime \cite{giavedoni-numerical}. Authors didn't take into
the account recent studies extending microchannel simulations for the capillary numbers
beyond the Bretherton regime. Thus, limiting comparison with other established CFD methods. Author
used the Shan-Chen model \cite{Shan-chen:extended} to simulate the multiphase behavior. It is also
the continuous interface model, but the study of grid dependence is absent.

{\color{red}
Level set method is represented by a number of works \cite{fukugata-levelset,
lakehal-micro, carlson-comparison}. While the bubble shapes and  were found in a good agreeement
with the experiments, the range of studied bubble lengths is confined to $2-3$ channels diameters.
Thus, the bubble radius changes significantly and cannot be used as classical Bretherton problem
benchmark. However, the works provide insight to the bubble formation and small bubbles flow in the
microchannels. Also, \citet{carlson-comparison} found a significant influence of the mutual bubbles
motion on the flow patterns.} 

Resolving the interface on a fine level for capillary numbers smaller than
$0.003$ is computationally expensive even in the two-dimensional case
(the amount of memory necessary to perform the simulation would be of the order
of tens or hundreds gigabytes).  This work is therefore based on a
comparison of the results obtained with the known data
validated for the Bretherton bubble flow.  In this paper, we present
techniques for initialization of the simulations and discuss optimal
parameter ranges for the binary liquid LB model.

\section{Lattice Boltzmann binary liquid model}
The lattice Boltzmann equation (LBE) operates on a rectangular grid representing the
physical domain. It utilizes
probability distribution functions (also known as particle populations)
containing information about
macroscopic variables, such as fluid density and momentum. LBE consists of
two parts: a local collision step, and a propagation step which transports
information from one node to another in certain
directions specified by the discrete velocity set.
The LBE is typically implemented as follows:
\begin{equation}
\label{standard:implementation}
\begin{aligned}
&f_i^{*}(\bm{x},t)=\omega f_i^{eq}(\bm{x},t)-(1-\omega) f_i(\bm{x},t) +
F_i,&&\text{ collision step}\\
&f_i(\bm{x}+\bm{c_i},t+1)=f_i^{*}(\bm{x},t),&&\text{ propagation step}, 
\end{aligned}
\end{equation}
where $f_i$ is the probability distribution function in the direction $\bm{c_i}$,
{\color{red} $f_i^{q}$ is the equilibrium probability distribution function}, $\omega$ is the
relaxation parameter, and $F_i$ is the external force population.{\color{red} The force population
is connected with the force and is implemented in the current work due to work \cite{guo}.} 

The binary fluid LB model is
based on a free-energy functional \cite{swift,landau}, and operates with two
sets of populations: one to track the pressure and the velocity fields, and another to represent the
phase field $\phi$ indicating the gas or liquid.

The model we use is a two-dimensional nine-velocity (D2Q9) model,
with equilibrium populations \cite{pooley-contact}:
\begin{equation}
\label{set:equilibrium:binary}
\begin{aligned}
&f_i^{eq}&&=w_i 
\biggl(3
p_0 - k \phi \Delta \phi
+\frac{u_{\alpha}c_{i\alpha}}{c_s^2}+\frac{Q_{i\alpha\beta}u_{\alpha } u_ {
\beta}}{2 c_s^4}\biggr)\\
&&&+k\bigl(w_i^{xx} (\partial_x \phi)^2+w_i^{yy} (\partial_y \phi)^2 +w_i^{xy} \partial_x
\phi \partial_y \phi \bigr), 1\leq i \leq 8\\
&f_0^{eq}&&=\rho-\sum_{i\neq0}{f_i^{eq}}\\
&g_i^{eq}&&=w_i\left(\Gamma \mu + \frac{\phi c_{i\alpha} u_{i\alpha}}{c_s^2}+\phi
\frac{Q_{i\alpha\beta}u_{\alpha}u_{\beta}}{2 c_s^4}\right), 1\leq i \leq 8 \\
&g_0^{eq}&&=\phi-\sum_{i\neq0}{g_i^{eq}}\quad,
\end{aligned}
\end{equation}
where $\Gamma$ is the mobility parameter; the chemical potential
$\mu=-A\phi+A\phi^3-k\Delta\phi$; $k$ is the parameter related to the surface
tension; $A$ is the parameter of the free-energy model. The bulk pressure
is expressed as $p_0=c_s^2 \rho +A (-0.5 \phi^2+0.75 \phi^4)$ {\color{red} with
the sound speed $c_s^2=1/3$}. 
Parameters specific to the D2Q9 grid are the weights
$w_i=\left\{\frac{4}{9},\frac{1}{9},\frac{1}{9},\frac{1}{9},\frac{1}{9},
\frac{1}{36},\frac{1}{36},\frac{1}{36},\frac{1}{36}\right\}$, and the tensor
$Q_{i\alpha\beta}=c_{i\alpha} c_{i\beta} - c_s^2 \delta_{\alpha\beta}$.  
{\color{red}
Other weights 
%related to the
%inclusion of the surface tension coefficient into the equations 
are as follows:}
$w^{xx}_{1-2}=w^{yy}_{3-4}=1/3$, $w^{xx}_{3-4}=w^{yy}_{1-2}=-1/6$,
$w^{xx}_{5-8}=w^{yy}_{5-8}=-1/24$, $w^{xy}_{1-4}=0$, $w^{xy}_{5-6}=1/4$ and
$w^{xy}_{7-8}=-1/4$. The set of equations (\ref{set:equilibrium:binary}) restores the
macroscopic
fluid equations as:
\begin{equation}
\begin{aligned}
&\partial_t \rho+ \partial_{\alpha} \rho u_{\alpha}=0\\
&\rho\left(\partial_t+u_{\beta}\partial_{\beta}\right) u_{\alpha}= F_{\alpha}
-\partial_{\beta}P_{\alpha \beta} +
\nu\partial_{\beta}\left(\partial_{\alpha}u_{\beta}+\partial_{\beta} u_{\alpha}\right)\\
&\partial_t \phi + \partial_{\alpha} \phi u_{\alpha}=M \partial^2_{\beta\beta} \mu,
\end{aligned}
\label{binary:fluid:system}
\end{equation}
where $\nu=c_s^2 (\tau-1/2)$ is the viscosity,
$M=\Gamma(\tau_{\phi}-1/2)$ is the mobility parameter, and $\tau=\frac{1}{\omega}$ and $\tau_{\phi}$
are the relaxation parameters of density and phase fields, {\color{red}
$P_{\alpha\beta}=\Bigl(p_0-k\phi \Delta \phi -\frac{k}{2}|\nabla \phi|^2\Bigr)\delta_{\alpha\beta}
+ k \partial_{\alpha} \phi \partial_{\beta} \phi$  \cite{pooley-contact}.The interface tension value
in the framework of the binary liquid model is $\gamma=\sqrt{\frac{8 k
A}{9}}$. The inclusion of the interface tension to the momentum flux tensor is done through the
coefficients $k$, $A$ and weights $w_i^{\alpha\beta}$.

Note that the first equation of system \ref{standard:implementation} simulates the continuity and
the Navier-Stokes equations, first two equations in (\ref{binary:fluid:system}). The second equation
of system \ref{standard:implementation} simulates the phase governing equation, third equation in
(\ref{binary:fluid:system}).} The system (\ref{binary:fluid:system}) allows the separation of the
liquid
phase with $\phi=1$ and a so-called gas phase with $\phi=-1$. The
relaxation time is taken as linearly dependent on the relaxation
times $\tau_{\mathrm{gas}}$ and $\tau_{\mathrm{liq}}$:
$\tau=\tau_{\mathrm{gas}}+\frac{\phi+1}{2}(\tau_{\mathrm{liq}}-\tau_{\mathrm{gas}})$. This allows
to change viscosity from the gas viscosity
$\nu_{\mathrm{gas}}=\frac{1}{3}\Bigl(\tau_{\mathrm{gas}}-\frac{1}{2}\Bigr)$ to the liquid viscosity
$\nu_{\mathrm{liq}}=\frac{1}{3}\Bigl(\tau_{\mathrm{liq}}-\frac{1}{2}\Bigr)$ while phase changes
accordingly.

{\color{red}
While the lattice Boltzmann system has parameters as gas and liquid
viscosities, the surface tension and etc., those parameters are not the representative and
proportional quantities of the parameters in a physical system. The parameters of the lattice
Boltzmann are connected with the physical world's parameters only through the non-dimensional
numbers governing a physics of the problem. In this case it's a capillary number $\Ca$, which is
obtained from the physical world and then it is matched through the lattice Boltzmann quantities.
In fact, one should distinguish the lattice Boltzmann system and the physical system. The set of
the fluid and phase equations \eqref{binary:fluid:system} is valid in the lattice Boltzmann space
and in the physical domain. Therefore, one can substitute any quantity, i.e.
$U_{\mathrm{bubble}}$, in the physical units or in the lattice Boltzmann units as soon as the
capillary number is matched in the both of worlds.} 

%\section{Lattice Boltzmann benchmark}
\section{Approach to benchmark}
To properly simulate and compare simulation results with the data
published in the literature, one needs to design a numerical benchmark addressing
the following challenges for the lattice Boltzmann method:
\begin{itemize}
 \item The diffuse nature of the interface in the multiphase model should not
influence the film thickness results.  The same applies to spurious
currents arising due to surface tension discretization, which
can influence mass transfer in the thin film, thereby compromising the
overall solution. Therefore, the diffuse interface should not noticeably affect the film
thickness.
 \item The wettability coefficient which in principle can control the
dynamic angle and the menisci appearance \cite{pagonabarraga-finger} should not
influence the overall solution.
 \item The free-energy model examined in this work is a single density, two
viscosities model. The classical Bretherton problem is a free-interface problem between liquid and
gas
where the film thickness is established by itself. Thus, the viscosity and the density ratios for
the
classical
Bretherton problem should
be large. However, in terms of the lattice Boltzmann binary liquid framework only the viscosity
ratio can be addressed. Our computations show that the results are consistent with other works and
inertial effects can be neglected.
  \item The Bretherton problem addresses a bubble flow driven by a pressure
difference, not a body force. However, to the best of our knowledge the pressure boundary
conditions are still not yet developed for the binary liquid model, because it involves the
treatment of associated gradients and Laplacians on the boundary.
This kind of pressure boundary conditions for the binary liquid model is currently
under development, and preliminary results show that the differences between flows driven by a body
force and by
pressure difference are small as far as the film
 thickness is concerned.  In this work we limit ourselves to the study
of body force driven flows, because of their simplicity and better numerical stability. This
implies that we can use the periodic boundary conditions in the streamwise direction. As soon as the
periodic boundary
conditions are applied, not a single bubble but a bubble train is simulated. In this case one
needs
to ensure that the distance between bubbles is large enough to exclude mutual bubble influence.
 \item Most simulations are done for a channel with circular cross section,
which is quite difficult to address in terms of lattice Boltzmann framework.
Although one can apply certain finite difference stencils
\cite{arnold-boundary,hunt-boundary} developed specifically for curved boundaries,
the analysis of error introduced by the boundary conditions becomes an issue. Although the circular
axis-symmetric case can be simulated on a rectangular grid by introducing specific mass and force
terms in the continuity and Navier-Stokes equation \cite{halliday-circular}, the lattice Boltzmann
incorporation of force and mass terms is in the process of development and validation. Therefore,
the benchmark is chosen as a plane-symmetric two-dimensional case.  
\end{itemize}
Given all the concerns and challenges, the suggested lattice Boltzmann framework
is a two-dimensional flow driven by a body force.  An analytical
solution to this problem is not known for a wide range of capillary
numbers.
Though some authors \cite{sehgal-microchannel} use the gravity driven model to
validate the Bretherton film thickness, the latter should be used with caution
since the velocity of the bubble is different from the fluid velocity and the
bubble shape
is different in the front and rear menisci depending on Bond number ($\mathrm{Bo}=\frac{\Delta \rho g
l^2}{\gamma}$). \citet{wong-films}
analytically described the film thickness variation along a bubble varying from $\Ca^{1/2}$ to
$\Ca^{2/3}$. The bubble should be long enough to have the film thickness proportional to
$\Ca^{2/3}$. Therefore, we chose the bubble length to be $5$ channel heights. This number is shown
to be sufficient to give results consistent with the theory. The
channel length is taken to be $3$ bubble lengths (or $15$ channel heights)
to minimize influence of one bubble on another,
because of the periodicity of boundary conditions.
Figure \ref{fig:benchmark:sketch} is a sketch of the geometry
used for the benchmark.
\begin{figure}
\includegraphics[width=0.97\textwidth]{Figures/benchmark_new.eps}
\caption{The benchmark sketch. $\delta$ corresponds to film thickness. $\xi$ corresponds to the interface thickness. We take the microchannel length to be 15 times larger than its height.
\label{fig:benchmark:sketch}}
\end{figure}


\section{Results}
\subsection{The nondimensionalization and initialization procedure}
\label{section:init}
We now introduce the procedure of nondimensionalization, as well as
the initialization technique we used to determine the parameters necessary for
the simulation. The capillary number defined in Eq.~\ref{capillary:number:definition} governs the
interface thickness.
%The bubble velocity $U_{\mathrm{bubble}}$ is taken in the center of the bubble where the film
%thickness is examined.
While parameters such as $\mu_{\mathrm{liq}}$, $\gamma$ and the capillary number $\Ca$ are given
or defined through the model parameters, the bubble velocity $U_{\mathrm{bubble}}$ is not given
explicitly.
In our simulations we approximate $U_{bubble}$ with the
Poiseuille profile center velocity, which is given as:
\begin{equation}
\begin{aligned}
U_{\mathrm{bubble}} \approx \frac{H_{\mathrm{eff}}^2}{8
\mu_{\mathrm{liq}}}\frac{\mathrm{d}P}{\mathrm{d}x}\\
U_{\mathrm{bubble}}\approx
\frac{{(N_y-2)}^2}{\frac{8}{6}(\tau_{\mathrm{liq}}-\frac{1}{2})}\frac{\mathrm{d}P}{\mathrm{d}
x } ,
\end{aligned}
\end{equation}
where $N_y$ is the grid number in the vertical direction. As will be discussed further, the
effective channel width is defined as $H_{\mathrm{eff}}=N_y-2$ because of bounce-back nodes to
mimic no-slip conditions at the walls.
For the Poiseuille profile one can estimate the body force (pressure gradient) through the
capillary number and grid resolution:
\begin{equation}
\label{poiseuille:velocity:center}
\begin{aligned}
&\frac{\mathrm{d}P}{\mathrm{d}x}=\frac{8}{{(N_y-2)}^2}\gamma \Ca.
\end{aligned}
\end{equation}
In simulations the body force (\ref{poiseuille:velocity:center}) causes the bubble
velocity to differ from that implied by the Poiseuille relation because of the bubble presence in a
flow. That is
why an iteration procedure is needed to achieve the 
desired velocity and 
capillary number. 
However, the initialization body force given by (\ref{poiseuille:velocity:center}) is a good
starting approximation. 

After one calculates the parameters to run a simulation, one has to
initialize the macroscopic fields and particle populations.
The velocity is initialized with zero everywhere. Populations are initialized
using the equilibrium values for the binary liquid model, including all the phase
gradients and Laplacians. The liquid phase is initialized with $\phi = 1$ and the
gas phase with $\phi = -1$. Though the initial film thickness
does not affect the final result for the front meniscus (see Fig.
\ref{fig:different:initialization:widths}) we keep the initialized film
thickness as close as possible to the already obtained numerical film
thickness values \cite{giavedoni-numerical}. This is done to minimize
the time  to convergence. %, as starting far away from the steady-state requires
%additional time for the relaxation.
\begin{figure}
\includegraphics*[bb=-15 360 630 430,width=0.97\textwidth]
{Figures/Init/initbegin12.eps}
\includegraphics*[bb=-15 360 630
430,width=0.97\textwidth]{Figures/Init/initfinish12.eps}\\
\includegraphics*[bb=-15 360 630 430,
width=0.97\textwidth]{Figures/Init/initbegin16.eps}
\includegraphics*[bb=-15 360 630
430,width=0.97\textwidth]{Figures/Init/initfinish16.eps}\\
\includegraphics*[bb=-15 360 630 430,
width=0.97\textwidth]{Figures/Init/initbegin20.eps}
\includegraphics*[bb=-15 360 630
430,width=0.97\textwidth]{Figures/Init/initfinish20.eps}\\
\caption{Phase plots for different bubble thicknesses as
$H_{\mathrm{eff}}-12$, $H_{\mathrm{eff}}-16$ and
$H_{\mathrm{eff}}-20$. The grid for the simulation is $102 \times 1501$. The results are rescaled
on $N_y$.The phase
profiles were obtained after $2\cdot10^5$ time steps. One can see that even if the
system is initialized with different bubble volumes, the bubbles always relax
to a shape where the film thickness is the same. For the given parameters ($Ca=0.05$) the
interface thickness rescaled at the effective channel width $H_{\mathrm{eff}}$  is
$0.0701$,$0.0697$,$0.0692$ measured at the {\color{red} center of the bubble}.
\label{fig:different:initialization:widths}}
\end{figure}

{\color{red}
For demonstration purposes we present the simulation parameters choice for $\Ca=0.05$.
In these
examples we use $k=0.04$ and $A=0.04$ as optimal binary liquid model parameters.
That explicitly implies the surface tension to be $\sqrt{\frac{8 k
A}{9}}=0.0377$ and the characteristic length of the interface
$5\sqrt{\frac{k}{A}}=5$ lattice Boltzmann units (grid nodes). For the sake of simplicity and
stability, the relaxation times for liquid and gas phases are taken as
$\tau_{\mathrm{liq}}=2.5$ and $\tau_{\mathrm{gas}}=0.7$, which correspond
to the liquid over gas kinematic viscosity ratio equal to $10$.

Overall, the setting simulations procedure can be described in steps as follows:
\begin{description}
 \item[Capillary number] One first needs to be supplied with the capillary number for
simulations. For the demonstration purposes we chose $\Ca=0.05$. 
 \item[Film thickness] After the capillary number is prescribed, one needs to approximate the film
thickness $\delta$. It can be done either by taking correlations from numerical simulations by
\citet{heil-bretherton} and \citet{giavedoni-numerical} or by using the classical Bretherton
correlation for small cappillary numbers $\delta=0.6687 \Ca^{2/3}$. In the case of $\Ca=0.05$, the 
film thickness is taken from correlations by \citet{heil-bretherton} 
%{\color{green}
%Fig.~\ref{fig:heil:planar}}
, and for Reynolds number $40$ equals $0.06$.  
\item[Grid choice] After pecifying the film thickness, one needs to choose the associate
number of nodes to resolve the film thickness. Note that for paremeters indicated above the
interface thickness is spread over approximately $5$ lattice units. The study of the interface
resolution to the film thickness, Section \ref{section:grid:refinement}, suggests to choose the
film thickness to be $2-2.5$ times larger than the interface thickness. Therefore, we want to
  resolve $6\%$ of the whole channel width with $12$ lattice units.  Thus, the channel
  width is $200$ lattice units. We take the bubble length equal to $5$ channel widths for the film
thickness to establish
  and the distance between bubbles as $3$ bubble lengths to avoid mutual influence of bubbles on
each other. Thus, the whole grid size is $200 \times 3000$.
 \item[Velocity] The relaxation parameters are taken to be in the stable range for simulations.
In the present simulations the viscosity ratio is $\dfrac{\mu_{liq}}{\mu_{gas}}=10$ with the
correspoding relaxation times $\tau_{liq}=2.5$ and $\tau_{gas}=0.7$. Given the viscosity of the
liquid one can obtain the velocity of the bubble from the capillary number: 
\begin{equation}
\begin{aligned}
&U_{\mathrm{bubble}}=\Ca \frac{\gamma}{\mu_{\mathrm{liq}}}=\Ca \frac{\sqrt{\frac{8 k
A}{9}}}{\frac{1}{3}(\tau_{\mathrm{liq}}-\frac{1}{2})}\\
&U_{\mathrm{bubble}}=0.05 \frac{0.0377}{0.6666}=2.82 \cdot10^{-3},
\end{aligned}
\end{equation}
where $\mu_{\mathrm{liq}}=1/3 (2.5-0.5)=0.6666$.
\item[Body force] 
Thus, it is desired to obtain the prescribed velocity $U_{\mathrm{bubble}}$ in the simulations. The
flow in the simulations is conducted by imposing the body force. Thus, the assumption is needed of
how the body force is connected with the bubble velocity $U_{\mathrm{bubble}}$. We assume that the
flow is close to the Poiseuille flow:
\begin{equation}
\frac{\mathrm{d}P}{\mathrm{d}x}=\frac{8\mu}{H_{\mathrm{eff}}^2}
U_{\mathrm{bubble}}=\frac{8}{N_y^2}\gamma \Ca=3.77\times 10^{-7}.  
\end{equation}
After imposing the body force the simulations can be run. A typical simulation runs approximately
$100000-300000$ time steps due to reach steady-state.
%Note that the velocity is proportional to the physical time step (small velocities imply longer
%running
%simulations):
%\begin{equation}
%\Delta t =\frac{U_{\mathrm{LBM}}}{U_{\mathrm{phys}}} \Delta x ,
%\end{equation}
%where, for example, the real velocities in the physical world can reach
%approximately $1$ m/s and the real height up to $1$ mm. In this case one
%can easily approximate the physical time step during one lattice Boltzmann iteration:
%\begin{equation}
%\Delta t = 7.05 \cdot 10^{-10} \,\mathrm{s}
%\end{equation}
%which is small.  That gives 
%physical time simulation around $10^{-5}-10^{-4}\,\mathrm{s}$, which is
%probably not enough for the physical system to come to the pseudo-steady state.
\end{description}
}
Note that following the prescribed procedure one can see that a computer memory requirements are
high for small capillary numbers due to large grids to resolve the film thickness. Thus, the
simulations in the present work cover range of capillary numbers from $0.05$ to $1.0$.
Although, Bretherton obtained an analytical solution for the range of low capillary
numbers $Ca \leq 0.005$, many researchers, for example \citet{giavedoni-numerical} and
\citet{heil-bretherton}, extended it to the range of capillary numbers
greater than
$0.005$, and to higher Reynolds numbers. %One can refer to figures
%  \ref{fig:giavedoni:planar} and \ref{fig:heil:planar} taken from the work of
%  \citet{giavedoni-numerical} and \citet{heil-bretherton}, who cross validated their
% simulations against the Bretherton data and each other.
%Even though the LBM can simulate
%flows with small capillary numbers, i.e. less than $0.005$, the simulation time
%is relatively long. 
Therefore, the focus of our work on the capillary range larger $\Ca\geq0.05$ is legitimate as far
as we base it on comparison with already cross validated
results for all ranges of capillary numbers.  Our intention is
  to show physically correct behavior for moderate $Ca$,
which
  can be easily and quickly validated on a computer.
%One can see from Fig.~\ref{fig:heil:planar} that the film thickness for the
%  capillary number $0.05$ ranges from $0.12$ to $0.15$ in a wide Reynolds
% number range (from $0$ to $300$).
%This gives a
%grid size of $400 \times 6000$. In terms of computer memory
%requirements, the calculations with double precision accuracy demand:
%\begin{equation}
%\begin{aligned}
%&2\text{ sets of populations } \times \,\, 8\,\, \text{bytes per population
%} \times \,\, 9 \text{
%populations}\\
%&\times\,400\,\times\,6000\approx 345 \mathrm{MB}. 
%\end{aligned}
%\end{equation}
%Even with an interface thickness of $62.5$ percent  of the
%film thickness, one gets (in 2D) a memory
%requirement of $345 \mathrm{MB}$. 
%\begin{figure}
%\includegraphics[width=0.97\textwidth]{Figures/giavedoni_planar.eps}
%\caption{\citet{giavedoni-numerical} gathered results across the
%literature for different capillary numbers (reprinted from \cite{giavedoni-numerical}). Results are
%scaled to the half-width of the
%channel. $h_{\infty}$ is the film thickness of air finger at
%the infinite distance from the front meniscus. \label{fig:giavedoni:planar}}
%\includegraphics[width=0.97\textwidth]{Figures/heil-planar.eps}
%\caption{\citet{heil-bretherton} performed simulations for different ranges of
%capillary numbers and Reynolds numbers (reprinted from \cite{heil-bretherton}). Results
%are scaled to the half-width of the channel. $h_{0}$ is the film thickness of air finger at
%the infinite distance from the front meniscus.
%\label{fig:heil:planar}}
%\end{figure}

Note that we base the initialization techniques on correlations for the
capillary number and the body force. However, in the binary liquid framework
those correlations are approximations. The strongest assumption is
in calculating the body force from the Poiseuille velocity profile.
In reality, the less viscous bubble moves faster than the surrounding liquid. By
substituting the obtained velocity in the capillary number equation, a
larger capillary number can be obtained. In practice, one needs to take the bubble velocity from the
simulations and
recalculate all the necessary flow characteristics, i.e. adjust the
 applied force to obtain the desired velocity/capillary number. However, simulations show that the
Poiseuille flow assumptions work reasonably well.

{\color{red}
Note that the initialization procedure is a good guide of designing the simulations. For example
for the grid refinement, Section \ref{section:grid:refinement}, we keep the same velocity
$U_{\mathrm{bubble}}$ and $\Ca$. This implies the conservation of the quantity
$H_{\mathrm{eff}}^2\frac{\mathrm{d}P}{\mathrm{d}x}=(N_y-2)^2\frac{\mathrm{d}P}{\mathrm{d}
x } = \mathrm{const}$. For the designing capillary range simulations, Section
\ref{section:capillary:range}, we use a proportionality law to initialize body forces knowing
results of just one simulation:
\begin{equation}
\begin{aligned}
&\Ca_{\mathrm{lit}} \propto U_{\mathrm{bubble}}\\
&U_{\mathrm{bubble}} \propto \frac{\mathrm{d}P}{\mathrm{d}x} H_{\mathrm{eff}}^2\\
&\Ca_{\mathrm{lit}} \propto \frac{\mathrm{d}P}{\mathrm{d} x} H_{\mathrm{eff}}^2 \text{ or }\\
&\frac{\mathrm{d}P}{\mathrm{d} x} \propto \frac{\Ca_{\mathrm{lit}}}{H_{\mathrm{eff}}^2},
\end{aligned}
\end{equation}
where the subscript ,,lit'' stands for the predicted capillary number
\cite{giavedoni-numerical,heil-bretherton}. 
}
\subsection{Grid refinement}
\label{section:grid:refinement}
To properly estimate the interface resolution one needs to study the convergence as a function of
the grid resolution. To do that the grid resolution is varied while all remaining parameters,
including the bubble velocity and the capillary number, are fixed.  Our goal is to determine the 
ratio of the interface thickness to the 
film thickness at which results are no longer dependent on the grid resolution.

Let us illustrate the procedure for the capillary number
$0.05$. As it was pointed out above, the film thickness in that case is $6$ percent of the
effective
channel $H_{\mathrm{eff}}$.
Note that in the case of the half-way bounce-back walls \cite{yu} which are used in the
simulations one needs to calculate the film thickness as:
\begin{equation}
\delta=(\phi_0-0.5)/(N_y-2),
\end{equation}
where $\phi_0$ is the grid coordinate where phase field is $0$, $N_y-2$
is the effective channel height.
If the grid size in the $y$ direction is $N_y$, then one has $N_y-1$ regions between the grid nodes
which represent
the physical domain. The effective wall location is in the middle between bounce-back and fluid nodes giving
overall $N_y-2$ nodes representing the fluid. Note that it is a simplification to impose the
boundary in the middle between the bounce-back
node and the fluid node. The location of the wall is
viscosity dependent \cite{ginzburg-multireflection}.  The effective location of the
wall for the
multiphase models to the best authors' knowledge is not yet derived. In the case of $\delta=0.06$
the
initial grid size is $N_y=102$, which gives the horizontal grid size as $N_x=15(N_y-2)=1500$.
The bubble is initialized as a rectangular box with coordinates
{\color{red}$y=7\frac{N_y-2}{100}\dots N_y-7\frac{N_y-2}{100}-1$}, $x=\frac{N_x}{3}\dots \frac{2
N_x}{3}$ and phase
$\phi_{\mathrm{bubble}}=-1$. All other nodes are initialized with the phase field
$\phi=1$. The force gradient can be estimated through the Poiseuille
profile formula, Eq.~\ref{poiseuille:velocity:center}, and it equals
$1.508 \cdot 10^{-6}$ lattice units.

{\color{red} After choosing the reference parameters, the grid refinement procedure
needs to keep the macroscopic parameters constant. One can refer to Section \ref{section:init}.}  
%It is easy to check
%that it yields the following quantity to
%be independent of grid size
%$H_{\mathrm{eff}}^2\frac{\mathrm{d}P}{\mathrm{d}x}=(N_y-2)^2\frac{\mathrm{d}P}{\mathrm{d}
%x } = \mathrm{const}$. 
We performed a number of simulations for the prescribed grids. The
simulation results in terms of grid numbers $N_x$, $N_y$, the film thickness $\delta$, center bubble
velocity $U_{bubble}$ are summarized in Table \ref{table:parameters:grid:refinement}.
The unified scaled profiles are shown in Fig. \ref{fig:grid:profiles}. One can
see that results converge for $H_{\mathrm{eff}}\geq 175$, and that with proper
initialization techniques, large enough time and different wall
wettabilities, results are different only in the 3rd digit even for
underresolved film thicknesses. To calculate how well the interface is
resolved, the ratio of the interface thickness to the film thickness is calculated. The
interface itself occupies approximately $5 \xi$, where
$\xi=\sqrt{k/A}=1$. The ratio of the interface thickness to the film thickness
$5\xi/H_{\mathrm{film}}$
 is shown in Table \ref{table:parameters:grid:refinement}. Based on these results one can conclude that
 the interface needs to be resolved as $40-50$ percent of the
expected film thickness for simulations to be grid independent. We further examine the
velocities in the center of the bubble to calculate the capillary number. One can see from Table
\ref{table:parameters:grid:refinement} that the bubble velocities are consistent and the
calculated capillary number corresponding to these velocities is $0.047$, which is {\color{red}
close to} the capillary number we aimed for. The corresponding difference can be
attributed to the Poiseuille profile body force initialization.% and the
 %density and viscosity ratios, which are much larger in the
%Bretherton problem.
\begin{figure}
\includegraphics[width=0.97\textwidth]{Figures/Grid/norm_grid_profs.eps}
\caption{Grid-refined profiles for the effective
channel widths
$H_{\mathrm{eff}}=100,125,150,175,200,225$.$\delta$ is scaled on $H_{\mathrm{eff}}$ and $\delta=0$
corresponds to the wall location. The profiles were taken at $x=14$ (nondimensional coordinates).
Capillary number is $\Ca=0.05$. The capillary number obtained from simulations $\Ca=0.047$. 
%One can seeconvergent results even for the underresolved film
%thickness.
\label{fig:grid:profiles}}
\end{figure}
%Here will be a consolidated table
\begin{table}
\begin{tabularx}{0.97\textwidth}{|X|X|X|X|X|X|X|}
\hline
$N_x$&$N_y$&$\delta$&$U_\mathrm{bubble}$&$\frac{5\xi}{H_{\mathrm{film}}}$&$N_\mathrm{iter}$&{
\color{red} $Re$}\\
\hline
$1500$&$102$&$0.0694$&$0.0028$&$0.824$&$200000$&$0.44$\\
\hline
$1875$&$127$&$0.0690$&$0.0028$&$0.646$&$250000$&$0.53$\\
\hline
$2250$&$152$&$0.0675$&$0.0027$&$0.539$&$300000$&$0.63$\\
\hline
$2625$&$177$&$0.0674$&$0.0027$&$0.453$&$350000$&$0.73$\\
\hline
$3000$&$202$&$0.0662$&$0.0027$&$0.400$&$400000$&$0.83$\\
\hline
$3375$&$227$&$0.0664$&$0.0026$&$0.355$&$450000$&$0.91$\\
\hline
\end{tabularx}
\caption{The parameters and results for grid resolution. The simulated domain is
of size $N_x \times N_y$. $U_\mathrm{bubble}$ is the velocity of the interface at the fron tip of
the bubble.  $5\xi$ is the interface thickness. $H_{\mathrm{film}}=\delta (N_y-2)$ is the size of
the film in
lattice Boltzmann units. $\Ca=0.05$ was taken to initialize the simulation.
\label{table:parameters:grid:refinement}}
\end{table}

\subsection{The influence of the wall gradient}
The simulation results should not depend on the wall wettability. Wettability is defined
through the phase gradient \cite{pooley-contact}, $\partial_n \phi$.  We took a large
enough grid in order for simulations to be consistent -- the grid size was
$177 \times 2626$ and the initial film thickness was
$12$ lattice Boltzmann units, which corresponds to the predicted film thickness.
We examined $11$ different values for the wall
gradient ranging from $-1$ to $1$. The parameters and results are summarized in Table
\ref{table:parameters:wall:gradient}. The results are consistent for all the
wall gradients given that the interface is properly resolved. For 
given wall gradients the values of interface thickness values are of $0.2\%$ relative accuracy.  For
the given wall gradients $0.8$
and $1.0$ the
simulations are unstable. One can see a few of the calculated phase profiles in Fig.
\ref{fig:gradients:profiles}. It shows that the negative wall gradient values cause 
non-physical phase values (above $1.0$ near the wall). One should attribute them to the numerical
adjustment of wall gradients through a first-order finite difference scheme. Note that
negative values of the phase gradient are
preferable, since the phase of the liquid adjacent to the wall has the value of $1$.
The phase values near the wall are above $1$ and do not interact
with the bubble which has phase value $-1$.  In case of positive
gradients, the values near the wall are below $1$, and the gradient profile can
fuse with the values of the gas phase. This case corresponds to  slug flow when gas is in
contact with the wall.
\begin{figure}
\includegraphics[width=0.97\textwidth]{Figures/Wall/phase_grad_profiles.eps}
\caption{Phase profiles for different wall gradients. One can see that if the thickness
is properly resolved then the wettability of the wall does affect the film thickness. The
simulations were conducted for $200,000$ iterations. The measured profile was taken at the
nondimensional coordinate scaled to $H_{\mathrm{eff}}$ as $x=11.42$. $\Ca=0.05$ was taken to
initialize simulation.
\label{fig:gradients:profiles}
}
\end{figure}

Another question that arises is the influence of the wall gradient on the bubble velocity and the
corresponding capillary number. The shear stress controlled by the wall phase gradient changes the
effective viscosity near the wall and the bubble velocity respectively. If the viscosity ratio is
high enough then the free surface motion of the bubble should not be dependent on the shear stress
near the wall.
One can see that if the film thickness is resolved properly the influence of the wall gradient can
be neglected. The velocities of the bubble center for profiles along $x$ direction are
presented in Table
\ref{table:parameters:wall:gradient}. 
%Fig. \ref{fig:velocities:wall:gradient} shows the center bubble velocity for different
%gradients. 
The average relative error for the mean velocity is $0.1\%$.
% Uncomment if you need this picture
% \begin{figure}
% \includegraphics[width=0.97\textwidth]{Figures/Wall/velocities_grad_profiles.eps}
% \caption{The center bubble velocity versus the phase gradient. One can neglect the influence of
% the wall once the film is properly resolved.
% \label{fig:velocities:wall:gradient}
% }
% \end{figure}
\begin{table}
\begin{tabularx}{\textwidth}{|X|X X X X X X X X X X X|}
\hline
$\scriptstyle \partial_n \phi$& $\scriptstyle -1.0$& $\scriptstyle -0.8$&
$\scriptstyle -0.6$&$\scriptstyle -0.4$&$\scriptstyle -0.2$&$\scriptstyle
0.0$&$\scriptstyle 0.2$&$\scriptstyle 0.4$&$\scriptstyle 0.6$&$\scriptstyle 0.8$&$\scriptstyle
1.0$\\
\hline
$\scriptstyle \delta$& $\scriptstyle 0.0633$& $\scriptstyle 0.0634$& $\scriptstyle 0.0634$&
$\scriptstyle 0.0634$& $\scriptstyle 0.0634$& $\scriptstyle 0.0634$& $\scriptstyle 0.0633$&
$\scriptstyle 0.0632$& $\scriptstyle 0.0631$ &$\scriptstyle \mathrm{N/A}$&$\scriptstyle
\mathrm{N/A}$\\
\hline
$\scriptstyle U_{bubble}$ &$\scriptstyle 0.0041$& $\scriptstyle 0.0042$& $\scriptstyle 0.0042$
&$\scriptstyle 0.0042$ & $\scriptstyle 0.0041$& $\scriptstyle 0.0041$ & $\scriptstyle 0.0042$ &
$\scriptstyle 0.0042$ & $\scriptstyle 0.0042$ & $\scriptstyle \mathrm{N/A}$ &$\scriptstyle
\mathrm{N/A}$\\
\hline
\end{tabularx}
\caption{The parameters and results for wall gradient effects on the film thickness.
$U_{\mathrm{bubble}}$
stands for the interface velocity. $\delta$ is the film thickness. $\partial_n \phi$ is the phase
gradient near the wall responsible for hydrophilic and hydrophobic behavior. The results are
calculated at the middle of the bubble after $200 000$ time iterations. $\Ca=0.05$ was taken to
initialize the simulations.
\label{table:parameters:wall:gradient}}
\end{table}

\subsection{The film variation over the bubble}
\label{section:film:thickness:variation}
Next, we investigated the variation of the film thickness over the bubble length.
The comparison for the thickness variation is presented in Fig.~\ref{fig:sehgal:bubble:length}.
\begin{figure}
\includegraphics[width=0.5\textwidth]{Figures/Bubble/bubble_sehgal_new.eps}\hfill
\includegraphics[width=0.5\textwidth]{Figures/Bubble/bubble_length_new.eps}\\
\caption{A qualitative comparison for the film thickness across
the bubble length. {\color{red} Left} (courtesy of \citet{sehgal-microchannel}),
{\color{red} Right}  (present simulations); $x$ is scaled to $H_{\mathrm{eff}}$
and increases in the flow direction.{\color{red} The data from
\cite{sehgal-microchannel} was digitally acquired by the program ``Engauge Digitizer'' and scaled
to compare with the present simulations.} \label{fig:sehgal:bubble:length}}
\end{figure}
One can see a qualitative agreement, i.e. the thickness increases towards the front meniscus and
rapidly decreases towards the rear meniscus. This shape is sometimes referred as a "bullet"
shape.


\subsection{Capillary number region}
\label{section:capillary:range}
The purpose of this section is to validate the correlations of
\citet{giavedoni-numerical} %in Fig. \ref{fig:giavedoni:planar} 
and
\citet{heil-bretherton} %in Fig. \ref{fig:heil:planar} 
for a range of capillary
numbers. Because of limited computational resources, we skip the
small capillary numbers and make calculations for the range of capillary numbers $0.03-0.8$, which
is a computationally reasonable task.  To be consistent with the previous sections, we choose the grid to be
$202 \times 3001$. Then $5$ lattice Boltzmann units do not occupy more than $60$
percent of the effective film thickness. Because the simulation gets unstable with
smaller grids and larger gradients, all the capillary number simulations were
performed on the same grid. To properly initialize the body force, the
proportionality law was utilized. The forcing
$6 \cdot 10^{-6}/16$ was chosen to obtain the predicted capillary
number $0.05$.  
The pressure gradient can be obtained through the capillary number
ratio, Section \ref{section:init}:
\begin{equation}
\frac{\mathrm{d}P}{\mathrm{d} x}=6 \cdot 10^{-6}/16 \frac{\Ca_{\mathrm{lit}}}{0.05}
\end{equation}
The film thickness is initialized through the ratio of capillary numbers as well:
\begin{equation*}
12 \frac{\Ca_{\mathrm{lit}}}{0.05}
\end{equation*}
The results obtained after $2\cdot10^5$ steps are presented in Table
\ref{table:parameters:capillary:number}. 
{\color{red} We chose to measure the film thickness in the middle of the bubble. The
classical Bretherton formulation is for the measurement of the film thickness at ``infinity''.
However, \citet{cerro-bubble-train} indicate that for the gravity-driven bubble train flow in tubes
it is enough for bubble to have a length of two-three diameters to apply analysis for very long
bubbles. In comparison with the axisymmetric circular geometry, for three-dimensional square shaped
microchannels \citet{heil-threedim} indicate the measurement of the film thickness at $5.5$
channel heights from the front bubble tip. This distance was shown sufficient for the
film thickness to establish itself for the capillary number range $\Ca<4$.
\citet{giavedoni-numerical} showed that the film stabilizes at the distances as $2.6-4.0$ diameters
from the front tip depending on the Reynolds number.  We chose to measure the film thickness in the
middle of the bubble, which is located at least at the distance of $2.5-3$ channel heights from the
front bubble tip. Moreover, the film thickness examination, see Section
\ref{section:film:thickness:variation}, shows that for the capillary range of interest, i.e.
$0.05\leq \Ca \leq 1$, the standard deviation from the bubble middle film thickness is around $7$
percent for small capillary numbers ($\Ca=0.05$) and less than $1$ percent for larger ones ($\Ca
\geq 0.1$) at the distances ranging from one channel height from the rear tip upto one channel
height to the front tip. This certainly validates the point of choice to measure bubble thickness.}
One can see that the calculated
capillary numbers are overpredicted but the obtained thicknesses are overpredicted
as well due to the body force setting caused by the Poiseuille flow assumption. If one
needs to obtain the desired capillary number, the shooting method for the forcing is
necessary, starting with the Poiseuille pressure gradient force as the initial condition. We extracted
the data of 
\citet{giavedoni-numerical} and \citet{heil-bretherton} and compared them with our results (see 
Fig. \ref{fig:capillary:comparison}).
\begin{figure}
\includegraphics[width=0.97\textwidth]{Figures/Capillary/capillaries_comparison_real.eps}
\caption{A comparison between simulation results and results of
\citet{giavedoni-numerical} and \citet{heil-bretherton}. One can see a
reasonable agreement. The plots depict the film thickness as a function of the
the capillary number. {\color{red} Data from \cite{giavedoni-numerical} was
extracted with the help of ``Engauge Digital Discretizer software'', data from
\citet{heil-bretherton} was extracted by hands using a set of curves involving interpolation and
it's the reason for a data to exhibit a noisy trend.} \label{fig:capillary:comparison}}
\end{figure}

\begin{table}
\begin{tabularx}{\textwidth}{|X|X|X|X|X|X|}
\hline
$Ca_{\mathrm{lit}}$&$\delta_{\mathrm{lit}}$&$\delta$&$U_{\mathrm{bubble}}$&$Ca$&{\color{red}$Re$}\\
\hline
$0.03$&$0.04$&$0.040$&$0.0014$&$0.026$&$0.449$\\
\hline
$0.05$&$0.06$&$0.058$&$0.0027$&$0.047$&$0.820$\\
\hline
$0.08$&$0.08$&$0.085$&$0.0045$&$0.080$&$1.378$\\
\hline
$0.1$&$0.1$&$0.076$&$0.0037$&$0.065$&$1.126$\\
\hline
$0.2$&$0.12$&$0.122$&$0.0125$&$0.222$&$3.807$\\
\hline
$0.4$&$0.13$&$0.151$&$0.0271$&$0.479$&$8.222$\\
\hline
$0.6$&$0.15$&$0.164$&$0.0416$&$0.736$&$12.617$\\
\hline
$0.8$&$0.16$&$0.172$&$0.0559$&$0.989$&$16.960$\\
\hline
\end{tabularx}
\caption{The parameters and results for capillary number region simulations.
$\delta_{\mathrm{lit}}$ is the film thickness with corresponding $\Ca_{\mathrm{lit}}$ taken from
literature. $\delta$ is the simulation film thickness with corresponding $\Ca$.
{\color{red}$U_{\mathrm{bubble}}$ is the interface velocity at the center axis.} $\Ca$ is based on
the measured bubble tip velocity
$U_{\mathrm{bubble}}$.
\label{table:parameters:capillary:number}}
\end{table}


\subsection{The influence of different viscosities}
The results presented above are taken for the liquid over gas kinematic viscosity ratio of $10$.
We performed the same simulations for the liquid over gas viscosity ratio of $20$.
The relaxation parameters were taken as $\tau_{\mathrm{liquid}}=4.5$ and $\tau_{\mathrm{bubble}}=0.7$. We
did not find any significant differences from the results presented above. The
comparison for the liquid film thicknesses is presented in Fig.
\ref{fig:capillary:viscous}. The results validate our assumption that in
the low capillary flow regime that the sufficiently high gas over liquid viscosity ratio ($\geq 10$) is sufficient to obtain results
consistent with the literature data.
\begin{figure}
\includegraphics[width=0.97\textwidth]{Figures/Capillary_Viscous/capillaries_viscous.eps}
\caption{The film thicknesses versus capillary number for
$\frac{\mu_{\mathrm{liq}}}{\mu_{\mathrm{gas}}}=10$ and $\frac{\mu_{\mathrm{liq}}}{\mu_{\mathrm{gas}}}=20$. \label{fig:capillary:viscous}}
\end{figure}

\section{Conclusion}
This work presents numerical studies of the
Bretherton/Taylor problem using the binary liquid lattice Boltzmann method. The bubble was chosen sufficiently long for the film
thickness to
stabilize, and periodic boundary conditions were used to keep the simulations robust.  A bubble
train was simulated instead of the motion of a single bubble, and care was taken to minimize
the mutual influence of neighboring bubbles. The computational
results in terms of capillary number dependence and shape of the bubbles show consistency with the
previously published data. Surprisingly, with large enough viscosity ratio the results are
independent of any inertial effects.  An examination of the influence of grid resolution on the results allowed
us to determine that the phase interface should be resolved as at least $50$ percent of the film thickness
in order for the simulations to be grid independent. Though our results are specific to the binary liquid lattice
Boltzmann method, the numerical hints and procedures can be used for any
continuous interface method.
\section{Acknowledgement}
A.~Kuzmin wants to thank Schlumberger for their financial support.
\bibliographystyle{model1-num-names}
\bibliography{paper}
%\bibliographystyle{unsrtnat}
%\bibliography{paper}
\end{document}
